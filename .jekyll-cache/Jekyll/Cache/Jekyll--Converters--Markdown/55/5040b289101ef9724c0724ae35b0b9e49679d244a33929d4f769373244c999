I"lE<p><img src="/assets/img/aws.png" alt="AWS" /></p>

<p>For test and production, Boxfuse runs your apps <strong>on your AWS account</strong>.</p>

<h2 id="environments">Environments</h2>

<p>By default Boxfuse creates two <a href="/docs/environments"><strong>environments</strong></a> you can use for running your apps on AWS: <code class="language-plaintext highlighter-rouge">test</code> and <code class="language-plaintext highlighter-rouge">prod</code>.</p>

<p>You do however have the option to create any number of <a href="/docs/environments#custom">additional custom environments</a> such
as <code class="language-plaintext highlighter-rouge">stage</code> or <code class="language-plaintext highlighter-rouge">demo</code> to cover all your needs.</p>

<h2 id="regions">Regions</h2>

<p>Your Boxfuse account comes preconfigured with its <strong>default region</strong> set to <code class="language-plaintext highlighter-rouge">eu-central-1</code>. This is the region that will be
used for the <code class="language-plaintext highlighter-rouge">test</code> and <code class="language-plaintext highlighter-rouge">prod</code> environments. You can change this region using the button below the globe on the overview
tab of the Boxfuse Console.</p>

<p>Boxfuse fully supports the <code class="language-plaintext highlighter-rouge">ap-northeast-1</code>, <code class="language-plaintext highlighter-rouge">ap-south-1</code>, <code class="language-plaintext highlighter-rouge">ap-southeast-1</code>, <code class="language-plaintext highlighter-rouge">ap-southeast-2</code>, <code class="language-plaintext highlighter-rouge">ca-central-1</code>,
<code class="language-plaintext highlighter-rouge">eu-central-1</code>, <code class="language-plaintext highlighter-rouge">eu-west-1</code>, <code class="language-plaintext highlighter-rouge">eu-west-2</code>, <code class="language-plaintext highlighter-rouge">sa-east-1</code>, <code class="language-plaintext highlighter-rouge">us-east-1</code>, <code class="language-plaintext highlighter-rouge">us-east-2</code>, <code class="language-plaintext highlighter-rouge">us-west-1</code> and <code class="language-plaintext highlighter-rouge">us-west-2</code> regions.</p>

<p>We recommend <strong>the regions in Australia, the EU and the US</strong> (<code class="language-plaintext highlighter-rouge">ap-southeast-2</code>, <code class="language-plaintext highlighter-rouge">eu-central-1</code>, <code class="language-plaintext highlighter-rouge">eu-west-1</code>, <code class="language-plaintext highlighter-rouge">us-east-1</code>,
<code class="language-plaintext highlighter-rouge">us-west-1</code> and <code class="language-plaintext highlighter-rouge">us-west-2</code>) as we have <strong>optimized them for AMI creation speed</strong> with new Amazon Machine Images created in
under 60 seconds. This is 5x to 10x faster than any other tool in the industry.</p>

<table class="table table-striped">
  <thead>
    <tr>
      <th>AWS Region</th>
      <th>AMI Creation Time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ap-northeast-1</td>
      <td>Less than 5 minutes</td>
    </tr>
    <tr>
      <td>ap-northeast-2</td>
      <td>Less than 5 minutes</td>
    </tr>
    <tr>
      <td>ap-south-1</td>
      <td>Less than 5 minutes</td>
    </tr>
    <tr>
      <td>ap-southeast-1</td>
      <td>Less than 5 minutes</td>
    </tr>
    <tr>
      <td><strong>ap-southeast-2</strong></td>
      <td><strong>Less than 60 seconds</strong></td>
    </tr>
    <tr>
      <td>ca-central-1</td>
      <td>Less than 5 minutes</td>
    </tr>
    <tr>
      <td><strong>eu-central-1</strong></td>
      <td><strong>Less than 60 seconds</strong></td>
    </tr>
    <tr>
      <td><strong>eu-west-1</strong></td>
      <td><strong>Less than 60 seconds</strong></td>
    </tr>
    <tr>
      <td>eu-west-2</td>
      <td>Less than 5 minutes</td>
    </tr>
    <tr>
      <td>sa-east-1</td>
      <td>Less than 5 minutes</td>
    </tr>
    <tr>
      <td><strong>us-east-1</strong></td>
      <td><strong>Less than 60 seconds</strong></td>
    </tr>
    <tr>
      <td>us-east-2</td>
      <td>Less than 5 minutes</td>
    </tr>
    <tr>
      <td><strong>us-west-1</strong></td>
      <td><strong>Less than 60 seconds</strong></td>
    </tr>
    <tr>
      <td><strong>us-west-2</strong></td>
      <td><strong>Less than 60 seconds</strong></td>
    </tr>
  </tbody>
</table>

<p>As Boxfuse expands its footprint, further regions will be optimized for fast deployment. The order will be based on 
customer usage and demand. This does not affect the runtime speed of your instance, which is determined by the instance 
type you selected.</p>

<h2 id="vpcs">VPCs</h2>

<p>Virtual Private Clouds let you isolate sections of the cloud at the network layer. Each AWS account comes with a default
VPC per region. You can create additional in the AWS Console should you have the need for it.</p>

<p>The <code class="language-plaintext highlighter-rouge">test</code> and <code class="language-plaintext highlighter-rouge">prod</code> <a href="/docs/environments">environments</a> are created within the default VPC of the default
AWS region you selected for your Boxfuse account.</p>

<p><strong>Note:</strong> It is currently not possible to select an AWS region that does not have a default VPC as your default region.
If your AWS account is missing a default VPC, you can ask AWS support to (re-)create it. Requests are usually fulfilled 
within a few hours.</p>

<p>You can use non-default VPCs as well as alternate regions in any <a href="/docs/environments#custom">custom environments</a> you
create.</p>

<h2 id="instance-types">Instance Types</h2>

<p>Boxfuse supports all <code class="language-plaintext highlighter-rouge">t3</code>, <code class="language-plaintext highlighter-rouge">t2</code>, <code class="language-plaintext highlighter-rouge">m5</code>, <code class="language-plaintext highlighter-rouge">m4</code>, <code class="language-plaintext highlighter-rouge">m3</code>, <code class="language-plaintext highlighter-rouge">c5</code>, <code class="language-plaintext highlighter-rouge">c4</code>, <code class="language-plaintext highlighter-rouge">c3</code>, <code class="language-plaintext highlighter-rouge">r5</code>, <code class="language-plaintext highlighter-rouge">r4</code> and <code class="language-plaintext highlighter-rouge">r3</code> instance types in all available regions.</p>

<h2 id="app-types">App Types</h2>

<p>All available <a href="/docs/apptypes">app types</a> are supported. Regardless of the app type you select, Boxfuse always performs
<strong>transactional zero downtime upgrades</strong> of your apps when you redeploy them. Boxfuse uses healthchecks to ensure that
a good version of your app can never be replaced by a bad one.</p>

<h2 id="security-groups">Security Groups</h2>

<p>Security groups control access to your instances at the network layer. Boxfuse automatically creates security groups for
you that match the ports you have specified when fusing your image. This effectively restricts inbound network traffic
to just the necessary ports.</p>

<p>By default Boxfuse will create both a security group for each application as well as a security group for each
deployment. The security group for the application can be used as a source in other security groups to restrict access
to only allow inbound access from instances of your application, regardless of the version currently deployed.</p>

<p>This security group created for each deployment in turn opens the exact set of ports required for that version of your
application with the appropriate <a href="/blog/restricted-ports">restrictions</a> if any were defined.</p>

<p>All security groups that have been created by Boxfuse are automatically removed when they are no longer in use.</p>

<h3 id="custom-security-groups">Custom Security Groups</h3>

<p>Alternatively you can also explicitly configure a custom security group for every app in each 
<a href="/docs/environments">environment</a> using the <a href="/docs/commandline/cfg#securitygroup"><code class="language-plaintext highlighter-rouge">securitygroup</code></a> property.. In this case, Boxfuse will not create any security groups for you and it is then
your responsibility to properly create, configure and decommission your security group.</p>

<h2 id="tags">Tags</h2>

<p>AWS Tags are a useful way to associate important metadata with AWS resources. Wherever supported by AWS and applicable all AWS resources created by Boxfuse are consistently tagged with one or more of the following tags:</p>

<table class="table table-striped">
  <thead>
    <tr>
      <th>AWS Tag Name</th>
      <th>Description</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">boxfuse:env</code></td>
      <td>The Boxfuse <a href="/docs/environments">environment</a></td>
      <td>prod</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">boxfuse:app</code></td>
      <td>The Boxfuse application</td>
      <td>myuser/myapp</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">boxfuse:image</code></td>
      <td>The Boxfuse image</td>
      <td>myuser/myapp:1.2.3</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Name</code></td>
      <td>(For EC2 instances only) The Boxfuse image and environment</td>
      <td>boxfuse myuser/myapp:1.2.3@prod</td>
    </tr>
  </tbody>
</table>

<h3 id="custom-tags">Custom Tags</h3>

<p>In addition to the standard tags created by Boxfuse you can also specify one or more custom tags that should be applied
to all created AWS resources using the <a href="/docs/commandline/cfg#tags"><code class="language-plaintext highlighter-rouge">tags</code></a> property. This is particularly useful for
things like cost allocation in your monthly AWS bill.</p>

<h2 id="elastic-ips">Elastic IPs</h2>

<p>An Elastic IP is a public IP address that can be freely remapped from one instance to another. When running a
<code class="language-plaintext highlighter-rouge">single-instance</code> app, Boxfuse will automatically provision an AWS Elastic IP in that
<a href="/docs/environments">environment</a>. As soon as healthchecks have passed for a deployment, your new instance becomes
reachable via the Elastic IP (as opposed to its initial public IP which it replaces). This is effectively makes the
Elastic IP the stable entry point into your application. Once the app is killed, the Elastic IP is also removed.</p>

<h3 id="custom-elastic-ips">Custom Elastic IPs</h3>

<p>If this auto-provisioning doesn’t work for you, you do have the option to set up your own Elastic IP and configure
Boxfuse to use it for a specific environment using the <a href="/docs/commandline/cfg#elasticip"><code class="language-plaintext highlighter-rouge">elasticip</code></a> property. This in
turn means that it is then also your responsibility to dispose of it when not needed anymore.</p>

<h2 id="albs">ALBs</h2>

<p>When running a <code class="language-plaintext highlighter-rouge">load-balanced-https</code> app, Boxfuse will automatically provision an AWS Application Load Balancer (ALB)
in that <a href="/docs/environments">environment</a> to distribute incoming requests across all your instances.
The ALB will also be tagged using the <code class="language-plaintext highlighter-rouge">boxfuse:app</code> and <code class="language-plaintext highlighter-rouge">boxfuse:env</code> tags described above as well as any additional
custom tags you may have defined. Once the app is killed, the ALB will also be removed.</p>

<p>Boxfuse configures each ALB it provisions to load-balance all HTTP and HTTPS ports of an image at layer 7. The same
ports and protocols exposed by your image are also exposed by the ALB. This means that for HTTPS ports,
the ALB terminates HTTPS connections and initiates new HTTPS connections to your instances, ensuring data in motion
remains fully encrypted at all times.</p>

<h3 id="target-groups">Target Groups</h3>

<p>For an auto-scaling group to be able to attach instances to an ALB, the ALB needs a target group. Boxfuse will
automatically provision and configure this target group for you and wire it up with both a listener for the ALB and
the auto-scaling group for the instances.</p>

<h3 id="custom-albs-and-target-groups">Custom ALBs and Target Groups</h3>

<p>If those defaults don’t work for you, you do have the option to set up your own ALB and Target Groups and configure Boxfuse
to use a specific Target Group for a specific environment using the <a href="/docs/commandline/cfg#targetgroup"><code class="language-plaintext highlighter-rouge">targetgroup</code></a>
property. This in turn means that it is then your entire responsibility to ensure it is configured correctly and
decommissioned when not needed anymore.</p>

<h2 id="elbs">ELBs</h2>

<p>When running a <code class="language-plaintext highlighter-rouge">load-balanced</code> app, Boxfuse will automatically provision an AWS Elastic Load Balancer (ELB)
in that <a href="/docs/environments">environment</a> to distribute incoming requests across all your instances.
The ELB will also be tagged using the <code class="language-plaintext highlighter-rouge">boxfuse:app</code> and <code class="language-plaintext highlighter-rouge">boxfuse:env</code> tags described above as well as any additional
custom tags you may have defined. Once the app is killed, the ELB will also be removed.</p>

<p>Boxfuse configures each ELB it provisions to load-balance all open ports of an image at layer 4 (TCP).
Unlike for layer 7 (HTTP, HTTPS) load balancing this means that HTTPS connections are only terminated on your
instance and ensures the entire path between client and instance remains fully encrypted.</p>

<h3 id="custom-elbs">Custom ELBs</h3>

<p>If those defaults don’t work for you, you do have the option to set up your own ELB and configure Boxfuse to use
it for a specific environment using the <a href="/docs/commandline/cfg#elb"><code class="language-plaintext highlighter-rouge">elb</code></a> property. This in turn means that it is then
your entire responsibility to ensure it is configured correctly and decommissioned when not needed anymore.</p>

<h2 id="auto-scaling-groups">Auto Scaling Groups</h2>

<p>When running a <code class="language-plaintext highlighter-rouge">load-balanced-https</code>, <code class="language-plaintext highlighter-rouge">load-balanced</code> or <code class="language-plaintext highlighter-rouge">worker</code> app, Boxfuse will automatically provision an AWS
Auto Scaling Group for each deployment. This Auto Scaling Group will then automatically ensure the configured
<a href="/docs/commandline/scale#capacity">capacity</a> will be met and automatically adjusted based on the configured triggers.</p>

<h2 id="instance-profiles">Instance Profiles</h2>

<p>To access other AWS services (using the AWS SDK for example) you need IAM credentials. While it is possible to bake
these directly into your image, AWS actually offers a better and more secure way to obtain them: IAM instance profiles.
Once an EC2 instance has been configured to use an IAM instance profile, AWS will automatically inject temporary IAM
credentials into the instance at launch time. They will then automatically be picked up by the AWS SDK when it connects
to a service.</p>

<h3 id="cloudwatch-logs">CloudWatch Logs</h3>

<p>By default for apps using CloudWatch Logs, Boxfuse configures your instances to use an IAM Instance Profile
that allows your application to invoke <code class="language-plaintext highlighter-rouge">logs:PutLogEvents</code>. This is required in order to be able to send log events to
CloudWatch Logs.</p>

<h3 id="custom-instance-profiles">Custom Instance Profiles</h3>

<p>You can however also very easily configure your app to use your own custom Instance Profile (which replaces any default
instance profile provided by Boxfuse) using the <a href="/docs/commandline/cfg#instanceprofile"><code class="language-plaintext highlighter-rouge">instanceprofile</code></a> property.</p>

<p>Note that if your app uses CloudWatch Logs, you must explicitly ensure it is be able to send logs to CloudWatch Logs
by including the following statement in the IAM policy attached to your custom instance profile:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"logs:PutLogEvents"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"arn:aws:logs:*:*:*"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p class="next-steps"><a href="/docs/domains" class="btn btn-primary">Custom Domains <i class="fa fa-arrow-right"></i></a></p>
:ET